#ç”¨äºæ›´æ–°å¯èƒ½å­˜åœ¨çš„é—®é¢˜,ä»¥åŠé¢˜åº“æ›´æ–°




#ä¿®å¤12é¢˜pod IPä¸å›ºå®šé—®é¢˜
#!/bin/bash

counter=0

while true; do
    sleep 3

    IP=$(kubectl -n nginx-static get pod -o jsonpath='{.items[0].status.podIP}' 2>/dev/null)
    echo "âœ… è·å–åˆ° IPï¼š$IP"

    # åˆ é™¤æ—§çš„ web.k8snginx.local è®°å½•
    sudo sed -i '/web\.k8snginx\.local/d' /etc/hosts
    echo "ğŸ§¹ å·²åˆ é™¤æ—§çš„ web.k8snginx.local æ¡ç›®"

    # å†™å…¥æ–°çš„ IP æ˜ å°„
    echo "$IP web.k8snginx.local" | sudo tee -a /etc/hosts
    echo "ğŸ‰ æ–° IP å·²å†™å…¥ /etc/hosts"

    # æ¯ 600 ç§’æ‰§è¡Œä¸€æ¬¡ applyï¼ˆ3 ç§’ Ã— 200 æ¬¡ï¼‰
    ((counter++))
    if (( counter >= 2 )); then
        echo "ğŸ”„ æ¯ 600 ç§’æ‰§è¡Œä¸€æ¬¡ apply..."
        counter=0
    fi
done
